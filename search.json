[{"path":"https://cbedwards-dfw.github.io/xldiff/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 xldiff authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Collin Edwards. Author, maintainer.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Edwards C (2025). xldiff: Compare excel sheets. R package version 0.1.0, https://framverse.r-universe.dev/xldiff.","code":"@Manual{,   title = {xldiff: Compare excel sheets},   author = {Collin Edwards},   year = {2025},   note = {R package version 0.1.0},   url = {https://framverse.r-universe.dev/xldiff}, }"},{"path":"https://cbedwards-dfw.github.io/xldiff/index.html","id":"xldiff","dir":"","previous_headings":"","what":"Compare excel sheets","title":"Compare excel sheets","text":"goal xldiff facilitate comparing excel sheets look changes, inspired diff tools. xldiff originally developed help compare inputs outputs different runs FRAM salmon model, stores inputs outputs excel files. However, comparison tools can used broadly compare different files structure, example monthly reports summarizing survey information, service use, finances. xldiff part FRAMverse R-Universe","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Compare excel sheets","text":"can install development version xldiff R-Universe like : Rtools remotes pak installed, can install source code like :","code":"install.packages(\"xldiff\", repos = \"https://framverse.r-universe.dev\") remotes::install_github(\"cbedwards-dfw/xldiff\") #OR # pak::pkg_install(\"cbedwards-dfw/xldiff\")"},{"path":[]},{"path":"https://cbedwards-dfw.github.io/xldiff/index.html","id":"creating-our-files","dir":"","previous_headings":"Example","what":"Creating our files","title":"Compare excel sheets","text":"can carry simple comparisons excel files excel_diff() function. begin , must two excel sheets generally similar, cells differing values. walk example, first must create two excel sheets. use first 20 rows penguins data palmerpenguins package (https://allisonhorst.github.io/palmerpenguins/).","code":"library(palmerpenguins) library(writexl)  # create our two data frames dat1 = dat2 = penguins[1:20,] ## convert $island to character for easier modification dat1$island = dat2$island = as.character(dat1$island) ## change several entries in dat2. dat2$island[10] = \"Scotland\" dat2$body_mass_g[6] = 365 dat2$bill_depth_mm[20] = 25    ## write to excel files, in sheet named \"penguins\". See ?writexl::writexlsx. write_xlsx(list(penguins = dat1),            path = \"example-penguins-1.xlsx\") write_xlsx(list(penguins = dat2),            path = \"example-penguins-2.xlsx\")"},{"path":"https://cbedwards-dfw.github.io/xldiff/index.html","id":"basic-example","dir":"","previous_headings":"Example","what":"Basic example","title":"Compare excel sheets","text":"two files hand, can use excel_diff compare : produces excel file shows highlights changes cells.","code":"library(xldiff)  excel_diff(file.1 = \"example-penguins-1.xlsx\",           file.2 = \"example-penguins-2.xlsx\",           results.name = \"penguin-file-comparison.xlsx\",           sheet.name = \"penguins\" )"},{"path":"https://cbedwards-dfw.github.io/xldiff/index.html","id":"adding-formatting","dir":"","previous_headings":"Example","what":"Adding formatting","title":"Compare excel sheets","text":"already key results xldiff: excel file identifies changed cells lists values first file second file. However, aside highlighting flag changed cells, rest document lacks formatting. Particularly complex spreadsheets (e.g. FRAM input outputs xldiff developed ), can easier contextualize changes “diff” file formatting. excel_diff() supports optional argument extra_format_fun. xldiff uses openxlsx package handle excel file formatting, extra_format_fun user-created function applies excel formatting using functions openxlsx (commonly createStyle, addStyle, setColWidths setRowHeights). first two arguments extra_format_fun must workbook object sheet name contained openxlsx functions make changes . simple example, might want increase font size bold first row (column headers), add thick border around first row entire block cells, add thinner borders surrounding individual cell block non-header cells. also increase column widths, otherwise cells changes can become hard read given extra content. facilitate applying borders groups cells, xldiff includes function add_cell_borders, takes one excel-style cell ranges applies borders either around block within block (depending value argument every.cell). write formatting function. details format openxlsx workbooks, see openxlsx documentation. call excel_diff new formatting function, output file prettier, (hopefully) easier read.","code":"library(openxlsx) format_fun = function(wb, sheet){   ## add bold and increased size for the first two rows.   addStyle(wb, sheet,                      style = createStyle(fontSize = 12, textDecoration = \"Bold\"),                      rows = 1, cols = 1:8, gridExpand = TRUE,                      stack = TRUE)   ## add thin inner cell borders   add_cell_borders(wb, sheet,                    block.ranges = c(\"A2:H21\"),                    border.thickness = \"thin\", every.cell = TRUE)   ## add thick outer borders   add_cell_borders(wb, sheet,                     block.ranges = c(\"A1:H1\", \"A1:H21\"),                    border.thickness = \"medium\")   setColWidths(wb, sheet, cols = 1:8, widths = c(14, 20, 14, 14, 14, 14, 14)) } excel_diff(file.1 = \"example-penguins-1.xlsx\",            file.2 = \"example-penguins-2.xlsx\",            results.name = \"penguin-file-comparison2.xlsx\",            sheet.name = \"penguins\",            extra_format_fun = format_fun )"},{"path":"https://cbedwards-dfw.github.io/xldiff/index.html","id":"tips-when-adding-formatting-with-extra_format_fun-","dir":"","previous_headings":"Example","what":"Tips when adding formatting with extra_format_fun =","title":"Compare excel sheets","text":"openxlsx’s addStyle(), optional argument stack = TRUE adds specified style top existing styles. can helpful handling complex overlapping formatting (e.g., specifying entire block background color, individual cells within bolded, several vertical borders split block, need specify three types style, possible combinations). xldiff includes helper function cell_range_translate() takes excel cell range (e.g. “B2:H6”) returns dataframe rows columns cell range. can fed row col arguments openxlsx functions. UPDATE: xldiff now includes cell_stylize(), helper function applies addStyle cells based excel cell range specifications! See . streamlines process transcribing excel formatting R code. cell highlighting changed cells added custom formatting, setting foreground color (e.g., cell_stylize()) interfere highlight.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/index.html","id":"using-cells_stylize","dir":"","previous_headings":"Example","what":"Using cells_stylize()","title":"Compare excel sheets","text":"example , increased font size added bolding using addStyle. , used following code: specified cells change rows cols arguments. applications, may looking multiple chunks cells need formatting. example, TAMMsupport package, needed add foreground shading thirty separate rectangular sections worksheet. addStyle either need separate addStyle call section, need work something clever specify rows columns. cells_stylize() simplifies process using block.ranges argument specify cells instead rows cols. block.ranges takes character vector (single character string) entry excel-style cell address range address (e.g. c(\"A1\", \"B2:D5\")). otherwise behaves addStyle, except take gridExpand argument, longer makes sense. replicate addStyle call , use simple case, ’s easy enough use addStyle, cells_stylize scales well adding styles multiple regions, uses excel-style ranges, ’s much easier write code directly based excel file.","code":"addStyle(wb, sheet,                      style = createStyle(fontSize = 12, textDecoration = \"Bold\"),                      rows = 1, cols = 1:8, gridExpand = TRUE,                      stack = TRUE) cells_stylize(wb, sheet,                      style = createStyle(fontSize = 12, textDecoration = \"Bold\"),                      block.ranges = c(\"A1:H1\"),                      stack = TRUE)"},{"path":"https://cbedwards-dfw.github.io/xldiff/index.html","id":"advanced-use","dir":"","previous_headings":"","what":"Advanced use","title":"Compare excel sheets","text":"complicated uses, sheet_comp() add_changed_formats() provide building blocks writing custom scripts functions. example, comparing excel files associated FRAM model, () wanted produce single file comparing three scripts, (b) invert colors numerical changes ranges cells (increased fish survival decreased fish harvest highlighted way), (c) round values cells comparing, numerical solvers often produced values different seventh eighth decimal place, don’t want highlight changes less tenth fish. required additional framework easily addressed excel_diff, implemented comparison tamm_diff function TAMMsupport package, https://github.com/cbedwards-dfw/TAMMsupport. writing functions, may useful use excel_diff starting template. Use print(excel_diff) view underlying code.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/add_cell_borders.html","id":null,"dir":"Reference","previous_headings":"","what":"Adds cell borders to openxlsx spreadsheet — add_cell_borders","title":"Adds cell borders to openxlsx spreadsheet — add_cell_borders","text":"calling sheet_diff(), creating new workbook diff contents, coloring highlight changed cells, original spreadsheet formatting lost. facilitate interpretting diff, can useful recreate major components original formatting, especially cell borders. function adds cell borders, designed ease use replicating formatting original excel file. Blocks cells give borders can specified original excel format (e.g. \"A1:D5\"). outside borders around block (default), use argument every.cell = FALSE. add cell borders within block generate grid appearance, set every.cell = TRUE. Note non-border formatting cell maintained, border formatting overwritten. adding thin boundaries inner cells thick outer border block cells, first use add_cell_borders every.cell = TRUE, appropriate border arguments (usually border.thickness = \"thin\") use every.cell = FALSE appropriate border arguments (usually border.thickness = \"medium\").","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/add_cell_borders.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adds cell borders to openxlsx spreadsheet — add_cell_borders","text":"","code":"add_cell_borders(   wb,   sheet,   block.ranges,   sheet.start = \"A1\",   every.cell = FALSE,   border.col = \"black\",   border.thickness = \"medium\" )"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/add_cell_borders.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adds cell borders to openxlsx spreadsheet — add_cell_borders","text":"wb openxlsx workbook object sheet character corresponding sheet name openxlsx workbook object wb. block.ranges One cell ranges specified excel format (e.g. c(\"A1:D5, \"B6\", \"A8:D8\")) sheet.start Optional. wb$sheet corresponds excel sheet wb$sheet entries read starting cell \"A1\" (e.g. readxl::read_excel range specified skip provided), provide top left cell read R order handle offsetting, can specify cell ranges based original excel file. every.cell want borders around individual cell cell block (TRUE), just around outer edges block (FALSE). Defaults FALSE. border.col Color border. See ?openxlsx::createStyle details. Defaults \"black\". border.thickness Thickness border. See ?openxlsx::createStyle details. Common choices: \"thin\", \"thick\".","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/add_changed_formats.html","id":null,"dir":"Reference","previous_headings":"","what":"Format openxlsx worksheet based on changes — add_changed_formats","title":"Format openxlsx worksheet based on changes — add_changed_formats","text":"Highlights cells changed, coloring differently increasing, decreasing, non-numeric cells. Typically used worksheet contains $sheet.diff dataframe sheet comparison provided cur.sheet argument. cases may useful define custom color schemes (e.g., increasing numbers good decreasing numbers bad, may want green red foregrounds types changes). Individual styles can provided optional arguments see ?openxlsx::createStyle options defining styles.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/add_changed_formats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format openxlsx worksheet based on changes — add_changed_formats","text":"","code":"add_changed_formats(   wb,   cur.sheet,   sheet.comp,   rows.invert = NULL,   cols.invert = NULL,   df.invert = NULL,   nofillStyle = NULL,   changeStyle = NULL,   posStyle = NULL,   negStyle = NULL )"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/add_changed_formats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format openxlsx worksheet based on changes — add_changed_formats","text":"wb openxlsx workbook make make changes. cur.sheet sheet name openxlsx workbook make changes. sheet.comp list comparison dataframes generated sheet_comp() rows.invert Optional vector row numbers invert color scheme increase vs decrease. cols.invert Optional vector column numbers invert color scheme increase vs decrease. df.invert Optional data frame $row $col entries indentify individual cells invert color schemes increase vs decrease. Defaults NULL. nofillStyle Optional openxlsx style object cells changes flagged. Default black text, white foreground. Create custom style openxlsx::createStyle(). changeStyle nofillStyle, non-numeric cells changed values. Default black text, light purple forecround. posStyle nofillStyle, numeric cells increase value. Default black text, light coral foreground. negStyle nofillStyle, numeric cells decrease value. Default black text, light green foreground.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/add_changed_formats.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Format openxlsx worksheet based on changes — add_changed_formats","text":"cases may make sense reverse color scheme numeric changes individual rows, columns, cells (e.g., scanning fishery model outputs, increasing fish escapement decreasing fish exploitation rates logically show color. Similarly, increasing profits decreasing costs logically show color.). Optional arguments rows.invert, cols.invert, df.invert allow specify individual regions dataframe reverse color scheme.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/cell_range_translate.html","id":null,"dir":"Reference","previous_headings":"","what":"Translates from excel cell address to rows and columns — cell_range_translate","title":"Translates from excel cell address to rows and columns — cell_range_translate","text":"Translates excel cell address rows columns","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/cell_range_translate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Translates from excel cell address to rows and columns — cell_range_translate","text":"","code":"cell_range_translate(x, expand = TRUE, start = \"A1\")"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/cell_range_translate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Translates from excel cell address to rows and columns — cell_range_translate","text":"x Single string individual cell cell range (e.g. \"D6\" \"D6:AC8\") expand TRUE (default), provides row column cells range. False, provides just row column start end cells. start Optional argument account offset matching cells excel file dataframe dataframe generated reading excel file starting location \"A1\".","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/cell_range_translate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Translates from excel cell address to rows and columns — cell_range_translate","text":"dataframe addresses cell range, $row gives row number $col gives column number.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/cell_range_translate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Translates from excel cell address to rows and columns — cell_range_translate","text":"","code":"cell_range_translate(\"D6\") #>   row col #> 1   6   4 cell_range_translate(\"A2:H3\") #>    row col #> 1    2   1 #> 2    3   1 #> 3    2   2 #> 4    3   2 #> 5    2   3 #> 6    3   3 #> 7    2   4 #> 8    3   4 #> 9    2   5 #> 10   3   5 #> 11   2   6 #> 12   3   6 #> 13   2   7 #> 14   3   7 #> 15   2   8 #> 16   3   8"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/cells_stylize.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply style to worksheet based on one or more excel-style cell ranges — cells_stylize","title":"Apply style to worksheet based on one or more excel-style cell ranges — cells_stylize","text":"Apply style worksheet based one excel-style cell ranges","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/cells_stylize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply style to worksheet based on one or more excel-style cell ranges — cells_stylize","text":"","code":"cells_stylize(wb, sheet, style, block.ranges, stack = TRUE)"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/cells_stylize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply style to worksheet based on one or more excel-style cell ranges — cells_stylize","text":"wb openxlsx workbook object sheet character corresponding sheet name openxlsx workbook object wb. style openxlsx cell style, created openxlsx::createStyle(). can include text size, bolding italics, text wrapping, foreground color, text color, etc. See ?openxlsx::createStyle details. block.ranges One cell ranges specified excel format (e.g. c(\"A1:D5, \"B6\", \"A8:D8\")) stack style appended existing styles (TRUE) replace existing styles (FALSE). Defaults TRUE.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/diff_to_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Compares two dataframes and returns diff as flextable — diff_to_table","title":"Compares two dataframes and returns diff as flextable — diff_to_table","text":"Workhorse function excel_diff_table(). Can used diff pair dataframes tibbles. Diff applied cell cell, results meaningful shape two objects .","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/diff_to_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compares two dataframes and returns diff as flextable — diff_to_table","text":"","code":"diff_to_table(   df1,   df2,   digits.signif = 6,   proportional.diff = FALSE,   dfnames = NULL,   excelify.col.names = FALSE )"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/diff_to_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compares two dataframes and returns diff as flextable — diff_to_table","text":"df1 first dataframe tibble df2 second dataframe tibble digits.signif comparing numeric values, decimal want round flagging changes? Also used limit printing changes? Numeric, defaults 4. proportional.diff flagging numeric changes based absolute differences ratio values, sheet2/sheet? TRUE, uses digits.signif identify proportional threshold. proportional.diff = TRUE digits.signif dfnames Character vector names two dataframes use table title. Optional. excelify.col.names columns identified excel letter convention? Defaults FALSE. Set TRUE comparing dataframes extracted excel sheets.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/diff_to_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compares two dataframes and returns diff as flextable — diff_to_table","text":"flextable object","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/diff_to_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compares two dataframes and returns diff as flextable — diff_to_table","text":"Diff table ROW mpg cyl disp hp drat wt qsec vs gear carb 2 21.0 6 160 110 3.90 2.875 17.02 0 1 4 4 2 21.0 -8 160 110 3.90 2.875 17.02 0 1 4 4 5 18.7 8 360 175 3.15 3.440 17.02 0 0 3 2 5 18.7 8 11 15 3.15 3.440 17.02 0 0 3 2","code":"df1 = mtcars df2 = mtcars df2[2,2] = -8 df2[5, c(3,4)] = c(11, 15) diff_to_table(df1, df2) .cl-7a5aafe2{}.cl-7a53b6a6{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7a53b6ba{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:rgba(255, 191, 189, 1.00);}.cl-7a53b6c4{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:rgba(155, 238, 180, 1.00);}.cl-7a56a4a6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7a56c602{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c603{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c616{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c620{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c621{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c622{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c62a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c62b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c634{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c635{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c63e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c648{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c649{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c64a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a56c652{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Diff tableROWmpgcyldisphpdratwtqsecvsamgearcarb221.061601103.902.87517.020144221.0-81601103.902.87517.020144518.783601753.153.44017.020032518.7811153.153.44017.020032"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/excel_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Minimal spreadsheet comparison function — excel_diff","title":"Minimal spreadsheet comparison function — excel_diff","text":"Compares single sheet two files, supports providing additional formatting form optional extra_format_fun argument. complex use cases (e.g., multiple sheet, pre-comparison formatting compare specific regions, etc) excel_diff can used simple template writing function. Small numeric differences cell values can result happenstance (\"decimal dust\") - digits.signif proportional.diff arguments can control behavior ignore minor numeric differences.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/excel_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Minimal spreadsheet comparison function — excel_diff","text":"","code":"excel_diff(   file.1,   file.2,   results.name,   sheet.name,   digits.signif = 3,   proportional.diff = TRUE,   extra_format_fun = NULL,   ... )"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/excel_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Minimal spreadsheet comparison function — excel_diff","text":"file.1 Filename (including path) first file compare file.2 Filename (including path) second file compare results.name Name (including path) file save comparison . Must end \".xlsx\" sheet.name character string sheet compare. sheets different names (compare two sheets one file), can take character vector length two, sheet names first second file order. case, results file use first sheet names. digits.signif Numeric, controls amount difference number needs identified differing two sheets. proportional.diff = TRUE, defines proportional change triggers \"diff\" status, number number digits proportion (2 = 1% difference, 3 = 0.1% difference, 4 = 0.01% difference). proportional.diff = FALSE, defines absolute difference triggers difference, digits round (1 = 0.1 difference, 2 = 0.01 difference, 3 = 0.001). proportional.diff minor differences cells judged absolute basis (FALSE) proportional basis (TRUE). FALSE useful identifying level decimal dust want worry diff-ing (e.g., \"differences 1000ths place smaller, care\"). TRUE useful sheet contains values varying magnitudes, allows specifying proprotional changes ignored diffing (e.g., \"value changed less 0.1%, care). extra_format_fun Optional function apply additional formatting, allowing users specify additional calls addStyle() (openxslx functions, like setting column width). First argument must workbook object function makes changes ; second argument must name worksheet function makes changes ... Additional arguments passed extra_format_fun","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/excel_diff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Minimal spreadsheet comparison function — excel_diff","text":"","code":"if (FALSE) { # \\dontrun{ filename.1 = \"Documents/WDFW FRAM team work/NOF material/NOF 2024/FRAM/Chin1124.xlsx\" filename.2 = \"Documents/WDFW FRAM team work/NOF material/NOF 2024/NOF 2/Chin2524.xlsx\"  excel_diff(file.1 = filename.1,           file.2 = filename.2,           results.name = \"Documents/WDFW FRAM team work/NOF material/NOF 2024/test1.xlsx\",           sheet.name = \"ER_ESC_Overview_New\" )  ## create function to add in some additional formatting: extra_form_fun = function(wb, sheet){  ## add bold and increased size for the first two rows.  openxlsx::addStyle(wb, sheet,                     style = openxlsx::createStyle(fontSize = 16, textDecoration = \"Bold\"),                     rows = 1:2, cols = 1:8, gridExpand = TRUE,                     stack = TRUE)  ## add thin inner cell borders  add_cell_borders(wb, sheet,                   block.ranges = c(\"B3:H34\") )  ## add thick outer borders  add_cell_borders(wb, sheet,                   block.ranges = c(\"A2\", \"B1:D2\", \"E1:H2\",                                    \"A3:A34\", \"B3:D34\", \"E3:H34\",                                    \"D36:H37\"),                   border.thickness = \"medium\") }  excel_diff(file.1 = filename.1,           file.2 = filename.2,           results.name = \"Documents/WDFW FRAM team work/NOF material/NOF 2024/test2.xlsx\",           sheet.name = \"ER_ESC_Overview_New\",           extra_format_fun = extra_form_fun ) } # }"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/excel_diff_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Diff excel sheets and show table — excel_diff_table","title":"Diff excel sheets and show table — excel_diff_table","text":"Similar excel_diff, returns flextable can displayed navigated Rstudio viewer. shows rows changed. every row changes, provides row , highlighting changed vlaues (red value file.1, green value file.2).\"ROWS\" column identifies excel row number columns identify excel column names. Defaults flagging changes least 0.1% file.1 file.2 (proportional.diff = TRUE, digits.signif = 3).","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/excel_diff_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diff excel sheets and show table — excel_diff_table","text":"","code":"excel_diff_table(   file.1,   file.2,   sheet.name,   digits.signif = 3,   proportional.diff = TRUE )"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/excel_diff_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diff excel sheets and show table — excel_diff_table","text":"file.1 Filename (including path) first file compare file.2 Filename (including path) second file compare sheet.name character string sheet compare. sheets different names (compare two sheets one file), can take character vector length two, sheet names first second file order. case, results file use first sheet names. digits.signif Numeric, controls amount difference number needs identified differing two sheets. proportional.diff = TRUE, defines proportional change triggers \"diff\" status, number number digits proportion (2 = 1% difference, 3 = 0.1% difference, 4 = 0.01% difference). proportional.diff = FALSE, defines absolute difference triggers difference, digits round (1 = 0.1 difference, 2 = 0.01 difference, 3 = 0.001). proportional.diff minor differences cells judged absolute basis (FALSE) proportional basis (TRUE). FALSE useful identifying level decimal dust want worry diff-ing (e.g., \"differences 1000ths place smaller, care\"). TRUE useful sheet contains values varying magnitudes, allows specifying proprotional changes ignored diffing (e.g., \"value changed less 0.1%, care).","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/excel_diff_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diff excel sheets and show table — excel_diff_table","text":"flextable object.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/excel_diff_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Diff excel sheets and show table — excel_diff_table","text":"","code":"if (FALSE) { # \\dontrun{ excel_diff_table(file.1 = \"C:/Repos/test file 1.xlsx\", file.2 = \"C:/Repos/test file 2.xlsx\", sheet = \"Sheet1\") } # }"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/formula_status_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare two sheets to see if formula use changed — formula_status_diff","title":"Compare two sheets to see if formula use changed — formula_status_diff","text":"Identifies one cells changed formula two excel sheets.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/formula_status_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare two sheets to see if formula use changed — formula_status_diff","text":"","code":"formula_status_diff(file.1, file.2, sheet.name)"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/formula_status_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare two sheets to see if formula use changed — formula_status_diff","text":"file.1 Filename (including path) first file compare file.2 Filename (including path) second file compare sheet.name character string sheet compare. sheets different names (compare two sheets one file), can take character vector length two, sheet names first second file order. case, results file use first sheet names.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/formula_status_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare two sheets to see if formula use changed — formula_status_diff","text":"Nothing","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/formula_status_diff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare two sheets to see if formula use changed — formula_status_diff","text":"","code":"if (FALSE) { # \\dontrun{ formula_status_diff(file.1 = \"CohoPugetSoundTAMMInputTemplate2025.xlsx\",    file.2 = \"CohoPugetSoundTAMMInputs 2025 v1.5.xlsx\",    sheet.name = \"Input_Harvestnew\") } # }"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/present_rows_changed.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize the rows changed between two dataframes — present_rows_changed","title":"Summarize the rows changed between two dataframes — present_rows_changed","text":"given two dataframes, uses sheet_comp compare two dataframes, presents rows changed: prints row numbers console, returns \"diff\" rows, column names matching excel column naming conventions.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/present_rows_changed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize the rows changed between two dataframes — present_rows_changed","text":"","code":"present_rows_changed(   t1,   t2,   digits.signif = 4,   trim.cols = TRUE,   diff.only = TRUE )"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/present_rows_changed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize the rows changed between two dataframes — present_rows_changed","text":"t1 First dataframe t2 Second dataframe, dimensions first. digits.signif comparing numeric values, decimal want round flagging changes? Also used limit printing changes? Numeric, defaults 4. trim.cols Remove unchanged columns? Useful wide dataframes viewing results console. Defaults TRUE. diff.Show changed values? defaults TRUE.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/present_rows_changed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize the rows changed between two dataframes — present_rows_changed","text":"diff two dataframes, similar $sheet.diff part return sheet_comp. Includes row_number column, remaining columns labeled match excel column naming conventions.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/sheet_comp.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare two dataframes of spreadsheets — sheet_comp","title":"Compare two dataframes of spreadsheets — sheet_comp","text":"Primary funtion xldiff package. cell values change dataframe t1 dataframe t2, corresponding $sheetdiff entry show [first value] -->  [second value]. Note changes presenting characters, changes numbers many digits can produce difficult--read cells. digits.signif can used determine many significant digits used identifying changes numeric values, many digits presented \"arrow\" cells. proprotional_diff allows toggling identifying changes based absolute value (FALSE) proportional changes (TRUE). example, proportional.diff = TRUE digits.signif = 2 flag numeric changes least 1%.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/sheet_comp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare two dataframes of spreadsheets — sheet_comp","text":"","code":"sheet_comp(t1, t2, digits.signif = 4, proportional.diff = FALSE)"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/sheet_comp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare two dataframes of spreadsheets — sheet_comp","text":"t1 First dataframe t2 Second dataframe, dimensions first. digits.signif comparing numeric values, decimal want round flagging changes? Also used limit printing changes? Numeric, defaults 4. proportional.diff flagging numeric changes based absolute differences ratio values, sheet2/sheet? TRUE, uses digits.signif identify proportional threshold. proportional.diff = TRUE digits.signif","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/sheet_comp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare two dataframes of spreadsheets — sheet_comp","text":"List comparison data frames, including logical matrices used formatting cells highlight changes. $sheet.diff: cell entries comparison $mat.changed logical matrix TRUE corresponds cell changed $mat.diff.decrease: logical matrix TRUE corresponds cell numeric values decreased = mat.diff.increase: , increases.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/sheet_comp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare two dataframes of spreadsheets — sheet_comp","text":"","code":"if (FALSE) { # \\dontrun{ ## using palmerpenguins data to simulate spreadsheets library(palmerpenguins) t1 = t2 = head(penguins) ## change island variable to characters for easier modification t2$island = t1$island = as.character(t1$island) ## change several entries in the second version t2$island[3] = \"Scotland\" t2$flipper_length_mm[1] = 18 sheet_comp(t1, t2, digits.signif = 4) } # }"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/sheet_comp_basic.html","id":null,"dir":"Reference","previous_headings":"","what":"Stripped down version of sheet_comp — sheet_comp_basic","title":"Stripped down version of sheet_comp — sheet_comp_basic","text":"Stripped version sheet_comp","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/sheet_comp_basic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stripped down version of sheet_comp — sheet_comp_basic","text":"","code":"sheet_comp_basic(t1, t2)"},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/sheet_comp_basic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stripped down version of sheet_comp — sheet_comp_basic","text":"t1 First dataframe t2 Second dataframe, dimensions first.","code":""},{"path":"https://cbedwards-dfw.github.io/xldiff/reference/sheet_comp_basic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stripped down version of sheet_comp — sheet_comp_basic","text":"logical matrix","code":""}]
