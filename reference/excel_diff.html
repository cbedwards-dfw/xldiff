<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Minimal spreadsheet comparison function — excel_diff • xldiff</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Minimal spreadsheet comparison function — excel_diff"><meta name="description" content='Compares a single sheet between two files, supports providing additional formatting
in the form of the optional extra_format_fun argument. For more complex use cases (e.g.,
multiple sheet, pre-comparison formatting to compare only specific regions, etc) excel_diff can
be used as a simple template for writing your own function. Small numeric differences between cell values can be the result of happenstance ("decimal dust") - the digits.signif and proportional.diff arguments can control behavior to ignore minor numeric differences.'><meta property="og:description" content='Compares a single sheet between two files, supports providing additional formatting
in the form of the optional extra_format_fun argument. For more complex use cases (e.g.,
multiple sheet, pre-comparison formatting to compare only specific regions, etc) excel_diff can
be used as a simple template for writing your own function. Small numeric differences between cell values can be the result of happenstance ("decimal dust") - the digits.signif and proportional.diff arguments can control behavior to ignore minor numeric differences.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xldiff</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cbedwards-dfw/xldiff/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Minimal spreadsheet comparison function</h1>
      <small class="dont-index">Source: <a href="https://github.com/cbedwards-dfw/xldiff/blob/main/R/excel_diff.R" class="external-link"><code>R/excel_diff.R</code></a></small>
      <div class="d-none name"><code>excel_diff.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compares a single sheet between two files, supports providing additional formatting
in the form of the optional <code>extra_format_fun</code> argument. For more complex use cases (e.g.,
multiple sheet, pre-comparison formatting to compare only specific regions, etc) <code>excel_diff</code> can
be used as a simple template for writing your own function. Small numeric differences between cell values can be the result of happenstance ("decimal dust") - the <code>digits.signif</code> and <code>proportional.diff</code> arguments can control behavior to ignore minor numeric differences.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">excel_diff</span><span class="op">(</span></span>
<span>  <span class="va">file.1</span>,</span>
<span>  <span class="va">file.2</span>,</span>
<span>  <span class="va">results.name</span>,</span>
<span>  <span class="va">sheet.name</span>,</span>
<span>  digits.signif <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  proportional.diff <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  extra_format_fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-file-">file.1<a class="anchor" aria-label="anchor" href="#arg-file-"></a></dt>
<dd><p>Filename (including path) for first file to compare</p></dd>


<dt id="arg-file-">file.2<a class="anchor" aria-label="anchor" href="#arg-file-"></a></dt>
<dd><p>Filename (including path) for second file to compare</p></dd>


<dt id="arg-results-name">results.name<a class="anchor" aria-label="anchor" href="#arg-results-name"></a></dt>
<dd><p>Name (including path) for file to save comparison to. Must end in ".xlsx"</p></dd>


<dt id="arg-sheet-name">sheet.name<a class="anchor" aria-label="anchor" href="#arg-sheet-name"></a></dt>
<dd><p>character string of sheet to compare. If the sheets have different names (or to compare two sheets in one file), can take a character vector of length two, with the sheet names from the first and second file in order. In this case, the results file will use the first of the sheet names.</p></dd>


<dt id="arg-digits-signif">digits.signif<a class="anchor" aria-label="anchor" href="#arg-digits-signif"></a></dt>
<dd><p>Numeric, controls the amount of difference a number needs to have to be identified as differing between the two sheets. When <code>proportional.diff = TRUE</code>, defines proportional change that triggers a "diff" status, where the number is the number of digits of the proportion (2 = 1% difference, 3 = 0.1% difference, 4 = 0.01% difference). When <code>proportional.diff = FALSE</code>, defines the absolute difference that triggers a difference, in digits of round (1 = 0.1 difference, 2 = 0.01 difference, 3 = 0.001).</p></dd>


<dt id="arg-proportional-diff">proportional.diff<a class="anchor" aria-label="anchor" href="#arg-proportional-diff"></a></dt>
<dd><p>Should minor differences between cells be judged on an absolute basis (<code>FALSE</code>) or a proportional basis (<code>TRUE</code>). <code>FALSE</code> is useful for identifying a level of decimal dust that we don't want to worry about when diff-ing (e.g., "If the differences is in the 1000ths place or smaller, I don't care"). <code>TRUE</code> is useful when a sheet contains values of varying magnitudes, as it allows specifying proprotional changes that should be ignored when diffing (e.g., "If the value changed by less than 0.1%, I don't care).</p></dd>


<dt id="arg-extra-format-fun">extra_format_fun<a class="anchor" aria-label="anchor" href="#arg-extra-format-fun"></a></dt>
<dd><p>Optional function to apply additional formatting, allowing users to specify additional
calls of <code><a href="https://rdrr.io/pkg/openxlsx/man/addStyle.html" class="external-link">addStyle()</a></code> (or other openxslx functions, like setting column width). First argument must be the workbook
object this function makes changes to; second argument must be the name of the worksheet this function makes
changes to</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code>extra_format_fun</code></p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">filename.1</span> <span class="op">=</span> <span class="st">"Documents/WDFW FRAM team work/NOF material/NOF 2024/FRAM/Chin1124.xlsx"</span></span></span>
<span class="r-in"><span><span class="va">filename.2</span> <span class="op">=</span> <span class="st">"Documents/WDFW FRAM team work/NOF material/NOF 2024/NOF 2/Chin2524.xlsx"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">excel_diff</span><span class="op">(</span>file.1 <span class="op">=</span> <span class="va">filename.1</span>,</span></span>
<span class="r-in"><span>          file.2 <span class="op">=</span> <span class="va">filename.2</span>,</span></span>
<span class="r-in"><span>          results.name <span class="op">=</span> <span class="st">"Documents/WDFW FRAM team work/NOF material/NOF 2024/test1.xlsx"</span>,</span></span>
<span class="r-in"><span>          sheet.name <span class="op">=</span> <span class="st">"ER_ESC_Overview_New"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## create function to add in some additional formatting:</span></span></span>
<span class="r-in"><span><span class="va">extra_form_fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">wb</span>, <span class="va">sheet</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="co">## add bold and increased size for the first two rows.</span></span></span>
<span class="r-in"><span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/addStyle.html" class="external-link">addStyle</a></span><span class="op">(</span><span class="va">wb</span>, <span class="va">sheet</span>,</span></span>
<span class="r-in"><span>                    style <span class="op">=</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/createStyle.html" class="external-link">createStyle</a></span><span class="op">(</span>fontSize <span class="op">=</span> <span class="fl">16</span>, textDecoration <span class="op">=</span> <span class="st">"Bold"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, gridExpand <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                    stack <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co">## add thin inner cell borders</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="add_cell_borders.html">add_cell_borders</a></span><span class="op">(</span><span class="va">wb</span>, <span class="va">sheet</span>,</span></span>
<span class="r-in"><span>                  block.ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B3:H34"</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co">## add thick outer borders</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="add_cell_borders.html">add_cell_borders</a></span><span class="op">(</span><span class="va">wb</span>, <span class="va">sheet</span>,</span></span>
<span class="r-in"><span>                  block.ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A2"</span>, <span class="st">"B1:D2"</span>, <span class="st">"E1:H2"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"A3:A34"</span>, <span class="st">"B3:D34"</span>, <span class="st">"E3:H34"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"D36:H37"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  border.thickness <span class="op">=</span> <span class="st">"medium"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">excel_diff</span><span class="op">(</span>file.1 <span class="op">=</span> <span class="va">filename.1</span>,</span></span>
<span class="r-in"><span>          file.2 <span class="op">=</span> <span class="va">filename.2</span>,</span></span>
<span class="r-in"><span>          results.name <span class="op">=</span> <span class="st">"Documents/WDFW FRAM team work/NOF material/NOF 2024/test2.xlsx"</span>,</span></span>
<span class="r-in"><span>          sheet.name <span class="op">=</span> <span class="st">"ER_ESC_Overview_New"</span>,</span></span>
<span class="r-in"><span>          extra_format_fun <span class="op">=</span> <span class="va">extra_form_fun</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Collin Edwards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

