<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Format openxlsx2 worksheet based on changes — add_changed_formats • xldiff</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Format openxlsx2 worksheet based on changes — add_changed_formats"><meta name="description" content="Highlights cells that changed, coloring differently for increasing, decreasing, and non-numeric cells.
Typically used on a worksheet that contains the $sheet.diff dataframe from the same sheet comparison as provided
in the cur_sheet argument. In some cases it may be useful to define custom color schemes (e.g., if increasing numbers are good
and decreasing numbers are bad, you may want green and red foregrounds for those types of changes). Individual colors can be provided for increasing, decreasing, or text changes.
Similarly, increasing profits and decreasing costs logically should both show the same color. Optional arguments rows_invert, cols_invert, and
df_invert allow you to specify individual regions of the dataframe to reverse the color scheme."><meta property="og:description" content="Highlights cells that changed, coloring differently for increasing, decreasing, and non-numeric cells.
Typically used on a worksheet that contains the $sheet.diff dataframe from the same sheet comparison as provided
in the cur_sheet argument. In some cases it may be useful to define custom color schemes (e.g., if increasing numbers are good
and decreasing numbers are bad, you may want green and red foregrounds for those types of changes). Individual colors can be provided for increasing, decreasing, or text changes.
Similarly, increasing profits and decreasing costs logically should both show the same color. Optional arguments rows_invert, cols_invert, and
df_invert allow you to specify individual regions of the dataframe to reverse the color scheme."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xldiff</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cbedwards-dfw/xldiff/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Format <code>openxlsx2</code> worksheet based on changes</h1>
      <small class="dont-index">Source: <a href="https://github.com/cbedwards-dfw/xldiff/blob/main/R/add_changed_formats.R" class="external-link"><code>R/add_changed_formats.R</code></a></small>
      <div class="d-none name"><code>add_changed_formats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Highlights cells that changed, coloring differently for increasing, decreasing, and non-numeric cells.
Typically used on a worksheet that contains the <code>$sheet.diff</code> dataframe from the same sheet comparison as provided
in the <code>cur_sheet</code> argument. In some cases it may be useful to define custom color schemes (e.g., if increasing numbers are good
and decreasing numbers are bad, you may want green and red foregrounds for those types of changes). Individual colors can be provided for increasing, decreasing, or text changes.
Similarly, increasing profits and decreasing costs logically should both show the same color. Optional arguments <code>rows_invert</code>, <code>cols_invert</code>, and
<code>df_invert</code> allow you to specify individual regions of the dataframe to reverse the color scheme.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_changed_formats</span><span class="op">(</span></span>
<span>  <span class="va">wb</span>,</span>
<span>  <span class="va">cur_sheet</span>,</span>
<span>  <span class="va">sheet_comp</span>,</span>
<span>  rows_invert <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cols_invert <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  df_invert <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  change_color <span class="op">=</span> <span class="st">"#E1C0FF"</span>,</span>
<span>  pos_color <span class="op">=</span> <span class="st">"#FFC7CE"</span>,</span>
<span>  neg_color <span class="op">=</span> <span class="st">"#C6EFCE"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-wb">wb<a class="anchor" aria-label="anchor" href="#arg-wb"></a></dt>
<dd><p>openxlsx2 workbook to make on which to make changes.</p></dd>


<dt id="arg-cur-sheet">cur_sheet<a class="anchor" aria-label="anchor" href="#arg-cur-sheet"></a></dt>
<dd><p>sheet name in openxlsx2 workbook on which to make changes.</p></dd>


<dt id="arg-sheet-comp">sheet_comp<a class="anchor" aria-label="anchor" href="#arg-sheet-comp"></a></dt>
<dd><p>list of comparison dataframes generated by <code><a href="sheet_comp.html">sheet_comp()</a></code></p></dd>


<dt id="arg-rows-invert">rows_invert<a class="anchor" aria-label="anchor" href="#arg-rows-invert"></a></dt>
<dd><p>Optional vector of row numbers to invert color scheme for increase vs decrease.</p></dd>


<dt id="arg-cols-invert">cols_invert<a class="anchor" aria-label="anchor" href="#arg-cols-invert"></a></dt>
<dd><p>Optional vector of column numbers to invert color scheme for increase vs decrease.</p></dd>


<dt id="arg-df-invert">df_invert<a class="anchor" aria-label="anchor" href="#arg-df-invert"></a></dt>
<dd><p>Optional data frame with <code>$row</code> and <code>$col</code> entries to identify individual cells to invert color schemes for increase vs decrease. Defaults to NULL.</p></dd>


<dt id="arg-change-color">change_color<a class="anchor" aria-label="anchor" href="#arg-change-color"></a></dt>
<dd><p>Hex code for color to highlight cells that changed (and were not numerics). Defaults to lavendar ("#E1C0FF").</p></dd>


<dt id="arg-pos-color">pos_color<a class="anchor" aria-label="anchor" href="#arg-pos-color"></a></dt>
<dd><p>As <code>change_color</code>, but for numeric cells that increase in value. Defaults to coral ("#E1C0FF").</p></dd>


<dt id="arg-neg-color">neg_color<a class="anchor" aria-label="anchor" href="#arg-neg-color"></a></dt>
<dd><p>As <code>change_color</code>, but for numeric cells that decrease in value. Defaults to light green ("#C6EFCE")</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Collin Edwards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

