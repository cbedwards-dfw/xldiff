<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Compare excel sheets • xldiff</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Compare excel sheets">
<meta name="description" content='`xldiff` provides tools to compare excel sheets, broadly inspired by "diff"-type functions. Provided functions can read sheets of two excel files and produce a third file that highlights cells that have changed. In the case of numeric changes, the direction of change is highlighted. These tools do not account for structural changes in the sheets (e.g., the addition of a column), but are useful in tracking changed values in tables or parameter files. Utility functions developed to streamline formatting output files are also more broadly useful in programmatically formatting excel files using openxlsx.'>
<meta property="og:description" content='`xldiff` provides tools to compare excel sheets, broadly inspired by "diff"-type functions. Provided functions can read sheets of two excel files and produce a third file that highlights cells that have changed. In the case of numeric changes, the direction of change is highlighted. These tools do not account for structural changes in the sheets (e.g., the addition of a column), but are useful in tracking changed values in tables or parameter files. Utility functions developed to streamline formatting output files are also more broadly useful in programmatically formatting excel files using openxlsx.'>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">xldiff</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cbedwards-dfw/xldiff/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="xldiff">xldiff<a class="anchor" aria-label="anchor" href="#xldiff"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of xldiff is to facilitate comparing excel sheets to look for changes, inspired by <code>diff</code> tools. <code>xldiff</code> was originally developed to help compare inputs and outputs for different runs of the FRAM salmon model, which stores both inputs and outputs in excel files. However, the comparison tools here can be used more broadly to compare different files with the same structure, for example monthly reports summarizing survey information, service use, or finances.</p>
<p>xldiff is part of the <a href="https://framverse.r-universe.dev/packages" class="external-link">FRAMverse R-Universe</a></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of xldiff from R-Universe like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"xldiff"</span>, repos <span class="op">=</span> <span class="st">"https://framverse.r-universe.dev"</span><span class="op">)</span></span></code></pre></div>
<p>If you have Rtools and <a href="https://remotes.r-lib.org" class="external-link">remotes</a> or <a href="https://pak.r-lib.org/" class="external-link">pak</a> installed, you can install from source code like so:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"cbedwards-dfw/xldiff"</span><span class="op">)</span></span>
<span><span class="co">#OR</span></span>
<span><span class="co"># pak::pkg_install("cbedwards-dfw/xldiff")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="section level3">
<h3 id="creating-our-files">Creating our files<a class="anchor" aria-label="anchor" href="#creating-our-files"></a>
</h3>
<p>We can carry out simple comparisons of excel files with the <code><a href="reference/excel_diff.html">excel_diff()</a></code> function. To begin with, we must have two excel sheets that are generally similar, but for which some cells have differing values. To walk through our example, we first must create two such excel sheets. Here we use the first 20 rows of the <code>penguins</code> data in the <code>palmerpenguins</code> package (<a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link uri">https://allisonhorst.github.io/palmerpenguins/</a>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link">palmerpenguins</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ropensci.r-universe.dev/writexl" class="external-link">writexl</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create our two data frames</span></span>
<span><span class="va">dat1</span> <span class="op">=</span> <span class="va">dat2</span> <span class="op">=</span> <span class="va">penguins</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span>
<span><span class="co">## convert $island to character for easier modification</span></span>
<span><span class="va">dat1</span><span class="op">$</span><span class="va">island</span> <span class="op">=</span> <span class="va">dat2</span><span class="op">$</span><span class="va">island</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">$</span><span class="va">island</span><span class="op">)</span></span>
<span><span class="co">## change several entries in dat2.</span></span>
<span><span class="va">dat2</span><span class="op">$</span><span class="va">island</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Scotland"</span></span>
<span><span class="va">dat2</span><span class="op">$</span><span class="va">body_mass_g</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="va">dat2</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">[</span><span class="fl">20</span><span class="op">]</span> <span class="op">=</span> <span class="fl">25</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">## write to excel files, in sheet named "penguins". See ?writexl::writexlsx.</span></span>
<span><span class="fu">write_xlsx</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>penguins <span class="op">=</span> <span class="va">dat1</span><span class="op">)</span>,</span>
<span>           path <span class="op">=</span> <span class="st">"example-penguins-1.xlsx"</span><span class="op">)</span></span>
<span><span class="fu">write_xlsx</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>penguins <span class="op">=</span> <span class="va">dat2</span><span class="op">)</span>,</span>
<span>           path <span class="op">=</span> <span class="st">"example-penguins-2.xlsx"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="basic-example">Basic example<a class="anchor" aria-label="anchor" href="#basic-example"></a>
</h3>
<p>With our two files in hand, we can use <code>excel_diff</code> to compare them. We need to specify the two files we are comparing, the name of the new file that will show the comparison, and the sheet we are comparing.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://framverse.r-universe.dev/xldiff" class="external-link">xldiff</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/excel_diff.html">excel_diff</a></span><span class="op">(</span>file_1 <span class="op">=</span> <span class="st">"example-penguins-1.xlsx"</span>,</span>
<span>          file_2 <span class="op">=</span> <span class="st">"example-penguins-2.xlsx"</span>,</span>
<span>          results_name <span class="op">=</span> <span class="st">"penguin-file-comparison.xlsx"</span>,</span>
<span>          sheet_name <span class="op">=</span> <span class="st">"penguins"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This produces an excel file that shows and highlights changes in cells.</p>
<p><img src="reference/figures/MAN/filev1.PNG"></p>
<p>We can also run a diff that displays in the “Viewer” section of Rstudio by using <code><a href="reference/excel_diff_table.html">excel_diff_table()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/excel_diff.html">excel_diff</a></span><span class="op">(</span>file_1 <span class="op">=</span> <span class="st">"example-penguins-1.xlsx"</span>,</span>
<span>          file_2 <span class="op">=</span> <span class="st">"example-penguins-2.xlsx"</span>,</span>
<span>          sheet_name <span class="op">=</span> <span class="st">"penguins"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/MAN/excel_diff_table.png"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/cbedwards-dfw/xldiff/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing xldiff</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Collin Edwards <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4937-5159" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Collin Edwards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
