# xldiff

The goal of xldiff is to facilitate comparing excel sheets to look for
changes, inspired by `diff` tools. `xldiff` was originally developed to
help compare inputs and outputs for different runs of the FRAM salmon
model, which stores both inputs and outputs in excel files. However, the
comparison tools here can be used more broadly to compare different
files with the same structure, for example monthly reports summarizing
survey information, service use, or finances.

xldiff is part of the [FRAMverse
R-Universe](https://framverse.r-universe.dev/packages)

## Installation

You can install the development version of xldiff from R-Universe like
so:

``` r
install.packages("xldiff", repos = "https://framverse.r-universe.dev")
```

If you have Rtools and [remotes](https://remotes.r-lib.org) or
[pak](https://pak.r-lib.org/) installed, you can install from source
code like so:

``` r
pak::pkg_install("cbedwards-dfw/xldiff")
#OR
remotes::install_github("cbedwards-dfw/xldiff")
```

To install the development version, which may include new features that
have been added but not thoroughly tested:

``` r
pak::pkg_install("cbedwards-dfw/xldiff@dev")
```

## Example

### Creating our files

We can carry out simple comparisons of excel files with the
[`excel_diff()`](https://cbedwards-dfw.github.io/xldiff/reference/excel_diff.md)
function. To begin with, we must have two excel sheets that are
generally similar, but for which some cells have differing values. To
walk through our example, we first must create two such excel sheets.
Here we use the first 20 rows of the `penguins` data in the
`palmerpenguins` package
(<https://allisonhorst.github.io/palmerpenguins/>).

``` r
library(palmerpenguins)
library(writexl)

# create our two data frames
dat1 = dat2 = penguins[1:20,]
## convert $island to character for easier modification
dat1$island = dat2$island = as.character(dat1$island)
## change several entries in dat2.
dat2$island[10] = "Scotland"
dat2$body_mass_g[6] = 365
dat2$bill_depth_mm[20] = 25



## write to excel files, in sheet named "penguins". See ?writexl::writexlsx.
write_xlsx(list(penguins = dat1),
           path = "example-penguins-1.xlsx")
write_xlsx(list(penguins = dat2),
           path = "example-penguins-2.xlsx")
```

### Basic example

With our two files in hand, we can use `excel_diff` to compare them. We
need to specify the two files we are comparing, the name of the new file
that will show the comparison, and the sheet we are comparing.

``` r
library(xldiff)

excel_diff(file_1 = "example-penguins-1.xlsx",
          file_2 = "example-penguins-2.xlsx",
          results_name = "penguin-file-comparison.xlsx",
          sheet_name = "penguins"
)
```

This produces an excel file that shows and highlights changes in cells.

![](reference/figures/MAN/filev1.PNG)

We can also run a diff that displays in the “Viewer” section of Rstudio
by using
[`excel_diff_table()`](https://cbedwards-dfw.github.io/xldiff/reference/excel_diff_table.md):

``` r
excel_diff(file_1 = "example-penguins-1.xlsx",
          file_2 = "example-penguins-2.xlsx",
          sheet_name = "penguins"
)
```

![](reference/figures/MAN/excel_diff_table.png)

# Package index

## All functions

- [`add_cell_borders()`](https://cbedwards-dfw.github.io/xldiff/reference/add_cell_borders.md)
  :

  **\[deprecated\]** Adds cell borders to openxlsx spreadsheet

- [`add_changed_formats()`](https://cbedwards-dfw.github.io/xldiff/reference/add_changed_formats.md)
  :

  Format `openxlsx2` worksheet based on changes

- [`cell_range_translate()`](https://cbedwards-dfw.github.io/xldiff/reference/cell_range_translate.md)
  : Translates from excel cell address to rows and columns

- [`cells_stylize()`](https://cbedwards-dfw.github.io/xldiff/reference/cells_stylize.md)
  **\[deprecated\]** :

  **\[deprecated\]** Apply style to worksheet based on one or more
  excel-style cell ranges

- [`diff_to_table()`](https://cbedwards-dfw.github.io/xldiff/reference/diff_to_table.md)
  : Compares two dataframes and returns diff as flextable

- [`excel_diff()`](https://cbedwards-dfw.github.io/xldiff/reference/excel_diff.md)
  : Minimal spreadsheet comparison function

- [`excel_diff_table()`](https://cbedwards-dfw.github.io/xldiff/reference/excel_diff_table.md)
  : Diff excel sheets and show table

- [`excel_diff_tibble()`](https://cbedwards-dfw.github.io/xldiff/reference/excel_diff_tibble.md)
  : Diff excel sheet and return tibble

- [`formula_diff()`](https://cbedwards-dfw.github.io/xldiff/reference/formula_diff.md)
  : Compare two sheets to see if formula use changed

- [`mat_to_a1()`](https://cbedwards-dfw.github.io/xldiff/reference/mat_to_a1.md)
  : Provide Excel addresses from matrix of logicals

- [`present_rows_changed()`](https://cbedwards-dfw.github.io/xldiff/reference/present_rows_changed.md)
  : Summarize the rows changed between two dataframes

- [`sheet_comp()`](https://cbedwards-dfw.github.io/xldiff/reference/sheet_comp.md)
  : Compare two dataframes of spreadsheets

- [`sheet_comp_basic()`](https://cbedwards-dfw.github.io/xldiff/reference/sheet_comp_basic.md)
  : Stripped down version of sheet_comp

- [`wb_get_col_widths()`](https://cbedwards-dfw.github.io/xldiff/reference/wb_get_col_widths.md)
  :

  **\[experimental\]** Get column widths of openxlsx2 Workbook sheet

